# 对象和类

## 1. 概述
面向对象的程序是由对象组成的，每个对象包含对用户公开的特定功能部分和隐藏的实现部分。在OOP中，不必关心对象的具体实现，只要能够满足用户的需求即可。OOP中数据被放在第一位，然后再考虑操作数据的算法。面向对象更适于解决规模较大的问题。设计面向对象的系统，首先从设计类开始，然后再往每个类中添加方法。
### 1.1 类、对象
类（class）是构造对象的模板或蓝图。由类构造对象的过程称为创建类的实例（instance）。对象中的数据称为实例域，操作数据的过程称为方法，对于每个特定的类实例（对象）都有一组特定的实例域值。这些值得集合就是这个对象的当前状态。

对象的三大特性：

 - 对象的行为 —— 可以对对象施加哪些操作，或可以对对象施加哪些方法？
 - 对象的状态 —— 当施加那些方法时，对象如何响应？
 - 对象标识 —— 如何辨别具有相同行为与状态的不同对象？

**对象状态的改变必须通过调用方法实现。**

### 1.2 类之间关系
类之间常见的关系：依赖（"uses-a"）、聚合（"has-a"）和继承（"is-a"）
依赖：如果一个类的方法操纵另一个类的对象
聚合：类A的对象包含类B的对象
继承：RushOrder类由Order类继承而来。

### 1.3 使用对象
要使用对象，就必须首先构造对象，并指定其初始状态。然后，对对象施加方法。
构造器的名字应该与类名相同。要想构造一个对象，需要在构造器前面加上`new`操作符。
**一个对象变量并没有实际包含一个对象，而仅仅引用一个对象。**`new`操作符的返回值也是一个引用。Java的对象变量看做C++的对象指针。所有的Java对象都存储在堆中。当一个对象包含另一个对象变量时，这个变量依然包含着指向另一个堆对象的指针。

## 2.用户自定义类
在一个源文件中，只能有一个公有类，但可以有任意数目的非公有类。文件名必须与**public**类的名字相匹配。
### 2.1 隐式参数与显示参数
```java
public void raiseSalary(double byPercent) {
  double raise = salary * byPercent / 100;
  salary += raise;
}

// 调用
number007.raiseSalary(5);
//实际执行
double raise = number007.salary * 5 / 100;
number007.salary += raise;
```
**raiseSalary方法**有两个参数。第一个参数称为隐式参数没事出现在方法名前的Employee类对象。第二个参数位于方法名后面括号中的数值，这是一个显式参数。
**在Java程序设计语言中，所有的方法都必须在类的内部定义，但并不表示它们是内联方法。是否将某个方法设置为内联方法是Java虚拟机的任务**。

### 2.2 封装的优点
有时需要获得或设置实例域的值。应该提供三项内容：（1） 一个私有的数据域；（2） 一个公有的域访问器方法；（3） 一个公有的域更改器方法。
这样做比提供一个简单的公有数据域复杂些，但却有着两个好处：（1） 可以改变内部实现，除了该类的方法之外，不会影响其他代码；（2） 更改器方法可以执行错误检查，然后直接对域进行赋值将不会进行这些处理。

私有方法的概念：希望将一个计算代码划分成若干个独立的辅助方法。通常这些辅助方法不应该成为公有接口的一部分，这是由于它们往往与当前的实现机制非常紧密，或者需要一个特别的协议以及一个特别的调序次序。

**final**修饰符大都应用于基本数据类型域，或不可变类的域(如果类中的每个方法都不会改变其对象，这种类就是不可变的类。例如String类就是一个不可变的类)。

## 3. 静态域与静态方法 `static`

### 3.1 静态域
将域定义为`static`，每个类中只有一个这样的域。而每一个对象对于所有的实例域却都有自己的一份拷贝。静态域属于类，而不属于任何独立的对象。

### 3.2 静态常量
静态变量使用的比较少，但静态常量却使用的比较多。
```java
public static final double PI = 3.1415926535;
```
还有经常使用的`System.out`，它在System类中的声明:
```java
public static final PrintStream out = ...;
```
### 3.3 静态方法
静态方法是一种不能向对象实施操作的方法。例如，Math类的pow方法。
使用情况有两种：（1） 一个方法不需要访问对象状态，其所需参数都是通过显式参数提供的；（2） 一个方法只需要访问类的静态域。

## 4. 方法参数
Java程序设计语言总数采用值调用。即方法得到的是所有参数值的一份拷贝，特别是，方法不能修改传递给它的任何参数变量的内容。
值调用（call by value）：表示方法接收的是调用者提供的值。
引用调用（call by reference ）：表示方法接收的是调用者提供的变量地址。
方法参数的使用情况：

* 一个方法不能修改一个基本数据类型的而参数（即数值型和布尔型）。
* 一个方法可以改变一个对象参数的状态。
* 一个方法不能实现让对象参数引用一个新的对象。

## 5. 对象构造

### 5.1 重载
```java
GregorianCalendar today = new GregorianCalendar();
//或者
GregorianCalendar deadline = new GregorianCalendar(2017,Calendar.DECEMBER,31);
```
这种特征叫做重载（overloading）。如果多个方法有相同的名字、不同的参数，便产生了重载。
**Java 允许重载任何方法。要完整地描述一个方法，需要指出方法名以及参数类型。这叫做方法的签名。返回类型不是方法签名的一部分。即不能有两个名字相同、参数类型也相同却返回不同类型值的方法。**

### 5.2 默认域初始化
数值为`0`，布尔值为`false`，对象引用为`null`。

### 5.3 默认构造器
当类中没有显式地写出类的构造器时，调用默认构造器即没有参数的构造器。
如果类中提供至少一个构造器，但是没有提供默认构造器，则在构造对象时如果没有提供构造参数就会被视为不合法。

### 5.4 调用另一个构造器
构造器的第一条语句形如`this(...)`，这个构造器将调用同一个类的另一个构造器。
```java
public Employee(double s) {
  this("Employee #" + nextId,s);
  nextId++;
}
```
当调用`new Employee(60000)`时，`Employee(double)`构造器将调用`Employee(String, double)`构造器。

### 5.5 初始化块
Java提供三种机制初始化数据域的方法:（1） 在构造器中设置值；（2） 在声明中赋值；（3）初始化块。
只要构造类的对象，这些块就会被执行。
```java
class Employee{
 ...
 ...
 private static int nextId = 1;

 private int id;
 ...
 //object initialization block
 {
   id = nextId;
   nextId++;
 }
}
```
**首先运行初始化块，然后才运行构造器的主体部分。**
如果对类的静态域进行初始化的代码比较复杂，那么可以使用静态的初始化块。
```java
//static initialization block
static
{
  Random generator = new Random();
  nextId = generator.nextId(10000);
}
```
在类第一次加载的时候，将会进行静态域的初始化。所有的静态初始化语句以及静态初始化块将依照类定义的顺序执行。

## 6. 包
Java允许使用包（package）将类组织起来。借助于包可以方便地组织自己的代码，并将自己的代码与别人提供的代码库分开管理。
类的导入：`import`
静态导入：`import static java.lang.System.*`
打印即可以表示：`out.println("...")`
包的作用域：没有声明修饰符，即是包可见。

### 7. 类设计技巧

* 一定将数据设计为私有。
* 一定要对数据初始化。
* 不要在类中使用过多的基本数据类型。
* 不是所有的域都需要独立的域访问器和域更改器。
* 使用标准格式进行类的定义。（无论采用哪种风格，重要的是保持一致）
* 将职责过多的类进行分解。
* 类名和方法名要能够体现他们的职责。